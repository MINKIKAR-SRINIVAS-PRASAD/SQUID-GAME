<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tic Tac Toe</title>
<style>
  :root{--bg:#3e5c8a;--card:#387b42;--accent:#3b8593;--muted:#94a3b8;--x:#906767;--o:#10b981}
  *{box-sizing:border-box}
  body{min-height:100vh;margin:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#8d2f2f,#4b6c26);font-family:Inter,system-ui,Segoe UI,Roboto,Arial;color:#9508f3;padding:20px}
  .app{width:420px;max-width:100%;background:linear-gradient(180deg,rgba(101, 188, 139, 0.16),transparent);border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(3, 22, 5, 0.6)}
  .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  h1{font-size:18px;margin:0;color:var(--accent)}
  .controls{display:flex;gap:8px;align-items:center}
  button{background:transparent;border:1px solid rgba(0, 0, 0, 0.868);color:inherit;padding:8px 10px;border-radius:8px;cursor:pointer}
  button.primary{background:var(--accent);color:#522222;border:none}
  .status{font-size:13px;color:var(--muted);margin-bottom:12px}

  /* board */
  .board{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;background:linear-gradient(180deg,rgba(106, 68, 24, 0.279),transparent);padding:12px;border-radius:10px}
  .cell{width:100px;height:100px;max-width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;background:rgba(147, 126, 41, 0.251);border-radius:8px;font-size:42px;font-weight:700;cursor:pointer;user-select:none}
  .cell.disabled{cursor:not-allowed;opacity:0.7}

  .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;font-size:13px;color:var(--muted)}
  .small{font-size:12px;color:var(--muted)}

  /* responsive */
  @media (max-width:480px){
    .cell{font-size:32px}
  }
</style>
</head>
<body>
  <div class="app" role="application" aria-labelledby="title">
    <div class="header">
      <h1 id="title">Tic Tac Toe</h1>
      <div class="controls">
        <button id="twoPlayer">2-Player</button>
        <button id="onePlayer" class="primary">1-Player</button>
        <button id="reset">Reset</button>
      </div>
    </div>

    <div class="status" id="status">Player X's turn</div>

    <div class="board" id="board" role="grid" aria-label="Tic tac toe board">
      <div class="cell" data-i="0" role="button" aria-label="cell 1"></div>
      <div class="cell" data-i="1" role="button" aria-label="cell 2"></div>
      <div class="cell" data-i="2" role="button" aria-label="cell 3"></div>
      <div class="cell" data-i="3" role="button" aria-label="cell 4"></div>
      <div class="cell" data-i="4" role="button" aria-label="cell 5"></div>
      <div class="cell" data-i="5" role="button" aria-label="cell 6"></div>
      <div class="cell" data-i="6" role="button" aria-label="cell 7"></div>
      <div class="cell" data-i="7" role="button" aria-label="cell 8"></div>
      <div class="cell" data-i="8" role="button" aria-label="cell 9"></div>
    </div>

    <div class="footer">
      <div class="small">Mode: <span id="mode">1-Player (X = you)</span></div>
      <div class="small">X <span id="scoreX">0</span> â€” <span id="scoreO">0</span> O</div>
    </div>
  </div>

<script>
  // Simple Tic Tac Toe with optional AI (Minimax optimal)
  const boardEl = document.getElementById('board');
  const cells = Array.from(document.querySelectorAll('.cell'));
  const statusEl = document.getElementById('status');
  const modeEl = document.getElementById('mode');
  const scoreXEl = document.getElementById('scoreX');
  const scoreOEl = document.getElementById('scoreO');

  const onePlayerBtn = document.getElementById('onePlayer');
  const twoPlayerBtn = document.getElementById('twoPlayer');
  const resetBtn = document.getElementById('reset');

  let boardState; // array of 9: 'X'|'O'|null
  let currentPlayer; // 'X' or 'O'
  let vsComputer = true;
  let scores = {X:0, O:0};
  let gameOver = false;

  const winningLines = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];

  function init(){
    boardState = Array(9).fill(null);
    currentPlayer = 'X';
    gameOver = false;
    cells.forEach(c => { c.textContent=''; c.classList.remove('disabled'); });
    updateStatus();
  }

  function updateStatus(msg){
    if(msg) { statusEl.textContent = msg; return; }
    if(gameOver) return;
    statusEl.textContent = `Player ${currentPlayer}'s turn`;
  }

  function makeMove(i){
    if(gameOver) return;
    if(boardState[i]) return;
    boardState[i] = currentPlayer;
    render();
    const winner = checkWinner(boardState);
    if(winner){
      endGame(winner);
      return;
    }
    if(boardState.every(Boolean)){
      endGame(null); // draw
      return;
    }
    // switch
    currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
    updateStatus();

    // if vs computer and it's O's turn (computer plays O)
    if(vsComputer && currentPlayer === 'O'){
      // small delay for UX
      setTimeout(() => {
        const move = bestMove(boardState, 'O');
        makeMove(move);
      }, 200);
    }
  }

  function render(){
    boardState.forEach((v,i) => {
      cells[i].textContent = v ? v : '';
      cells[i].style.color = v === 'X' ? 'var(--x)' : 'var(--o)';
    });
  }

  function checkWinner(b){
    for(const line of winningLines){
      const [a,b1,c] = line;
      if(b[a] && b[a] === b[b1] && b[a] === b[c]) return b[a];
    }
    return null;
  }

  function endGame(winner){
    gameOver = true;
    if(winner){
      updateStatus(`Player ${winner} wins!`);
      scores[winner]++;
      scoreXEl.textContent = scores['X'];
      scoreOEl.textContent = scores['O'];
      // highlight winning line
      highlightWinningLine(winner);
    } else {
      updateStatus('Draw');
    }
    // disable cells
    cells.forEach(c => c.classList.add('disabled'));
  }

  function highlightWinningLine(winner){
    for(const line of winningLines){
      const [a,b,c] = line;
      if(boardState[a] === winner && boardState[b] === winner && boardState[c] === winner){
        [a,b,c].forEach(i => cells[i].style.boxShadow = 'inset 0 0 0 4px rgba(255,255,255,0.03)');
        break;
      }
    }
  }

  // Minimax for optimal play (computer plays O)
  function bestMove(b, player){
    // If empty board, play center
    if(b.every(item => item === null)) return 4;
    let bestScore = -Infinity;
    let move = -1;
    const avail = availableMoves(b);
    for(const idx of avail){
      const copy = b.slice();
      copy[idx] = player;
      const score = minimax(copy, false, player);
      if(score > bestScore){ bestScore = score; move = idx; }
    }
    return move;
  }

  function minimax(b, isMaximizing, aiPlayer){
    const human = aiPlayer === 'O' ? 'X' : 'O';
    const winner = checkWinner(b);
    if(winner === aiPlayer) return 10;
    if(winner === human) return -10;
    if(b.every(Boolean)) return 0;

    if(isMaximizing){
      let best = -Infinity;
      for(const idx of availableMoves(b)){
        const copy = b.slice(); copy[idx] = aiPlayer;
        const val = minimax(copy, false, aiPlayer);
        best = Math.max(best, val);
      }
      return best;
    } else {
      let best = Infinity;
      for(const idx of availableMoves(b)){
        const copy = b.slice(); copy[idx] = human;
        const val = minimax(copy, true, aiPlayer);
        best = Math.min(best, val);
      }
      return best;
    }
  }

  function availableMoves(b){
    const moves = [];
    b.forEach((v,i) => { if(!v) moves.push(i); });
    return moves;
  }

  // events
  cells.forEach(c => c.addEventListener('click', () => {
    const i = +c.dataset.i;
    // if vsComputer and it's computer's turn, ignore clicks
    if(vsComputer && currentPlayer === 'O') return;
    makeMove(i);
  }));

  onePlayerBtn.addEventListener('click', ()=>{
    vsComputer = true; onePlayerBtn.classList.add('primary'); twoPlayerBtn.classList.remove('primary');
    modeEl.textContent = '1-Player (X = you)';
    init();
  });

  twoPlayerBtn.addEventListener('click', ()=>{
    vsComputer = false; twoPlayerBtn.classList.add('primary'); onePlayerBtn.classList.remove('primary');
    modeEl.textContent = '2-Player (X / O)';
    init();
  });

  resetBtn.addEventListener('click', ()=>{
    scores = {X:0, O:0}; scoreXEl.textContent = 0; scoreOEl.textContent = 0; init();
  });

  // keyboard accessibility: 1-9 keys map to cells
  window.addEventListener('keydown', (e)=>{
    if(e.key >= '1' && e.key <= '9'){
      const idx = parseInt(e.key,10)-1;
      // map 1..9 to positions (top-left..bottom-right)
      makeMove(idx);
    }
    if(e.key === 'r' || e.key === 'R') init();
  });

  // init defaults
  twoPlayerBtn.classList.remove('primary');
  onePlayerBtn.classList.add('primary');
  init();
</script>
</body>
</html>
